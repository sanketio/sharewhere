var sw_object,marker,geocoder,infowindow,magnific_popup;!function(o){sw_object={init:function(){sw_object.load_google_map()},load_google_map:function(){o("#sw-map").magnificPopup({type:"inline",modal:!1,callbacks:{open:function(){sw_object.google_map_intialize()}}}),magnific_popup=o.magnificPopup.instance},google_map_intialize:function(){o("#sw-location-type").removeClass("sw-location-type-error");var e=new google.maps.LatLng(18.5204393,73.8567347),t={zoom:17,mapTypeId:google.maps.MapTypeId.ROADMAP,streetViewControl:!1},n=new google.maps.Map(document.getElementById("sw-google-map"),t);navigator.geolocation?navigator.geolocation.getCurrentPosition(function(o){sw_object.mark_out_location(n,o.coords.latitude,o.coords.longitude)},function(){sw_object.handle_no_geo_location(!0,e,n)}):sw_object.handle_no_geo_location(!1,e,n),sw_object.search_google_map(n)},handle_no_geo_location:function(o,e,t){!0===o?alert(admin_strings.geolocation_service_failed):alert(admin_strings.geolocation_not_supported_browser),t.setCenter(e)},mark_out_location:function(o,e,t){geocoder=new google.maps.Geocoder,infowindow=new google.maps.InfoWindow;var n=new google.maps.LatLng(e,t);geocoder.geocode({location:n},function(e,t){t===google.maps.GeocoderStatus.OK?e[1]?(o.setCenter(n,17),marker=new google.maps.Marker({position:n,draggable:!0,map:o}),infowindow.setContent(e[0].formatted_address),infowindow.open(o,marker),sw_object.store_location(e[0]),google.maps.event.addListener(marker,"dragend",function(e){sw_object.geocode_position(o,marker.getPosition())}),google.maps.event.addListener(marker,"click",function(e){sw_object.geocode_position(o,marker.getPosition())}),google.maps.event.addListener(o,"click",function(e){sw_object.geocode_position(o,e.latLng)})):window.alert(admin_strings.no_result_found):window.alert(admin_strings.geocoder_failed+" "+t)})},geocode_position:function(o,e){geocoder.geocode({latLng:e},function(t){t&&t.length>0?(marker.formatted_address=t[0].formatted_address,sw_object.store_location(t[0])):marker.formatted_address=admin_strings.not_determine_location,o.setCenter(e,17),marker.setPosition(e),infowindow.setContent(marker.formatted_address),infowindow.open(o,marker)})},search_google_map:function(o){var e=new google.maps.places.Autocomplete(document.getElementById("sw-map-search"));e.bindTo("bounds",o),google.maps.event.addListener(e,"place_changed",function(){var t=e.getPlace();if(!t.geometry)return void window.alert(admin_strings.auto_complete_no_geometry);var n=t.geometry.location.G,a=t.geometry.location.K,i=new google.maps.LatLng(n,a);sw_object.geocode_position(o,i)})},store_location:function(e){for(var t,n,a,i=0;i<e.address_components.length;i++)"locality"===e.address_components[i].types[0]?t=e.address_components[i]:"administrative_area_level_1"===e.address_components[i].types[0]?n=e.address_components[i]:"country"===e.address_components[i].types[0]&&(a=e.address_components[i]);o("#sw-city").val(t.long_name),o("#sw-state").val(n.long_name),o("#sw-country").val(a.long_name),o("#sw-store-location").val(e.formatted_address)},append_location:function(e){var t=o("#sw-location-type");if(""===e){if(!confirm(admin_strings.full_address_confirmation))return void t.addClass("sw-location-type-error");e="full",t.removeClass("sw-location-type-error")}var n=sw_object.final_location(e),a='<a title="'+n+'" href="https://google.com/maps?q='+decodeURIComponent(n)+'" target="_blank">'+n+"</a>";if("undefined"==typeof tinymce){var i=tinymce.get("content");if(i&&i instanceof tinymce.Editor)i.setContent(i.getContent()+" "+a),i.save({no_events:!0});else{var s=o("textarea#content");s.val(s.val()+" "+a)}}t.val(""),magnific_popup.close()},final_location:function(e){var t=o("#sw-city").val(),n=o("#sw-state").val(),a=o("#sw-country").val(),i=o("#sw-store-location").val(),s=[];return s.city=t,s.state=n,s.country=a,s["city-state"]=t+", "+n,s["city-country"]=t+", "+a,s["state-country"]=n+", "+a,s["city-state-country"]=t+", "+n+", "+a,s.full=i,s[e]}},o("document").ready(function(){sw_object.init(),o("#sw-insert-button").click(function(e){e.preventDefault(),sw_object.append_location(o("#sw-location-type").val())})})}(jQuery);